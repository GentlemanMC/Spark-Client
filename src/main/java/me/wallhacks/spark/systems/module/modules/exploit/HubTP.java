package me.wallhacks.spark.systems.module.modules.exploit;

import me.wallhacks.spark.Spark;
import me.wallhacks.spark.event.player.PacketReceiveEvent;
import me.wallhacks.spark.event.player.PacketSendEvent;
import me.wallhacks.spark.event.player.PlayerUpdateEvent;
import me.wallhacks.spark.systems.module.Module;
import net.minecraft.network.play.client.CPacketConfirmTeleport;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraft.network.play.server.SPacketPlayerPosLook;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;

import java.util.Random;

@Module.Registration(name = "HubTP", description = "Teleports you up to the netherhub")
public class HubTP extends Module {
    @SubscribeEvent
    public void onUpdate(PlayerUpdateEvent event) {
        if(mc.player.dimension != -1)
        {
            Spark.sendInfo("You are not in the nether :(");
            disable();
            return;
        }
        if (mc.player.posY >= 120) disable();
        mc.player.connection.sendPacket(new CPacketPlayer.Position(posX(), new Random().nextInt(50) + 127, posZ(), mc.player.onGround));
        mc.player.connection.sendPacket(new CPacketConfirmTeleport(Spark.positionManager.teleportId));
    }

    @SubscribeEvent
    public void onPacketSend(PacketSendEvent event) {
        if (event.getPacket() instanceof CPacketPlayer.Position || event.getPacket() instanceof CPacketPlayer.PositionRotation) {
            ((CPacketPlayer) event.getPacket()).y += 0.3;
        }
    }
}