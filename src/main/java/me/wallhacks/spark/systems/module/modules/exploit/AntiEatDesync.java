package me.wallhacks.spark.systems.module.modules.exploit;

import me.wallhacks.spark.event.player.PlayerProcessRightClickEvent;
import me.wallhacks.spark.systems.module.Module;
import me.wallhacks.spark.systems.setting.settings.BooleanSetting;
import net.minecraft.item.ItemFood;
import net.minecraft.network.play.client.CPacketPlayerTryUseItem;
import net.minecraft.world.GameType;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;

@Module.Registration(name = "AntiEatDesync", description = "Stop eat desync")
public class AntiEatDesync extends Module {
    BooleanSetting better = new BooleanSetting("Better", this, false);

    @SubscribeEvent
    public void onUseItem(PlayerProcessRightClickEvent event) {
        if (mc.player == event.getPlayer())
            if (mc.playerController.currentGameType != GameType.SPECTATOR) {
                if (mc.player.getHeldItem(event.getHand()).getItem() instanceof ItemFood) {
                    mc.player.connection.sendPacket(new CPacketPlayerTryUseItem(event.getHand()));
                    if (better.getValue())
                        mc.player.connection.sendPacket(new CPacketPlayerTryUseItem(event.getHand()));
                }
            }
    }
}
